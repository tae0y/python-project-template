# .claude/ 리뷰 — 2026-02-22  
  
**검토자:** 5인 에이전트 팀 (Prompt Engineer, Agent Harness Evangelist, Token CFO, Code Quality Lead, Onboarding New Member)  
**검토 대상:** `.claude/` 디렉터리, `real-estate-mcp`·`that-night-sky` 워크로그, ADR, learn 파일  
**방법:** 상호 반론 요건을 포함한 3라운드 구조적 토론  
  
---  
  
## 총평  
  
**현재 `.claude/` 설정은 이 개발자에게 도움이 되고 있다 — 다만 특정 두 파일에서 의미 있는 마찰이 발생하고 있다.**  
  
증거 기반(두 프로덕션 규모 프로젝트의 워크로그, ADR, learn 파일)을 보면 `coding-guidelines.md`에 대한 강한 준수율을 확인할 수 있다(Rule 2, 4, 5, 6, 7, 8 모두 구체적인 채택 산출물 존재). 문서 관리 규칙(`localdocs/`)도 일관되게 지켜지고 있다. 훅(`check-new-test-file.sh`, `check-external-lib-usage.sh`)은 범위가 잘 정의되어 있고 올바르게 조정되어 있다(하드 블록 vs 권고).  
  
설정이 실패하는 곳은 정확히 두 군데다. `thinking-guidelines.md`는 스킬과 영문 커밋 컨벤션이 요구하는 구조화된 출력과 명백히 모순된다 — 즉 규칙이 매 세션마다 조용히 위반되고 있다. 그리고 `tdd-guardian.md`는 Python 프로젝트에 어울리지 않는 TypeScript 관용구로 오염되어 있다. 이 두 파일만 수정하면 시스템이 실질적으로 개선된다. 나머지는 점진적인 개선 사항이다.  
  
---  
  
## 우선순위별 액션 목록  
  
### P1 — `tdd-guardian.md`를 Python/pytest 예시로 재작성  
**담당: New Member 관점 (전원 동의)**  
**근거:** 전체 `.claude/` 설정에서 혼란이 아닌 *잘못된 동작*을 유발하는 유일한 문제다. "Project-Specific Guidelines" 섹션(284–315번 줄)은 TypeScript/Zod/interface 규칙을 마치 이 프로젝트의 규칙인 것처럼 명시하고 있다. 이 지침을 따르는 Python 개발자는 pytest에 Jest 스타일 패턴을 작성하게 된다. 이는 전체 설정에 대한 신뢰를 훼손하고 잘못된 코드를 생성한다.  
**범위:** `jest.spyOn`/`beforeEach`/`let` 예시를 `pytest` 픽스처 및 `monkeypatch`로 교체. TypeScript 타입 어노테이션을 Python 타입 힌트로 교체. 가이드라인에서 "TypeScript strict mode", "Zod", "`type` vs `interface`" 제거. TDD 방법론 내용(RED-GREEN-REFACTOR 사이클)은 모두 유지.  
**예상 공수:** 1–2시간 (범위 명확, 비논쟁적, 전원 합의)  
  
---  
  
### P2 — `thinking-guidelines.md` 삭제, 4–5줄을 `CLAUDE.md`에 인라인으로 추가  
**담당: Token CFO + Prompt Engineer (New Member 동의)**  
**근거:** `thinking-guidelines.md`에는 세 가지 핵심 모순이 있다.  
- Rule 3은 "기본적으로 일반 텍스트; 요청 없으면 헤딩/목록 사용 금지"라고 명시 — 구조화된 마크다운을 생성하는 모든 스킬(worklog, planning, check, tdd-guardian)이 이를 위반한다  
- Rule 3은 범위 경계 없이 "한국어로 작성"을 명시 — 영문을 요구하는 `commit-convention.md`와 상충한다  
- Rule 2(멀티 페르소나 분석)는 두 프로젝트·약 40개 워크로그 항목 전체에서 채택 증거가 없다 — 실증된 가치 없이 출력 토큰만 늘리는 죽은 규칙이다  
  
**제안하는 대체문** (`CLAUDE.md`의 `## Communication and Reasoning Style` 섹션 아래 추가):  
```markdown  
- 한국어(해요/어요 체)로 답변. 간결하고 분석적으로. 필러 없음, 이모지 없음.  
- 결론을 먼저, 제약은 다음에. 긍정 형태 우선("B다", "A가 아니다"가 아니라).  
- 복잡한 질문에 답하기 전에 검증 가능한 사실, 가정, 사용자 선호를 분리.  
- 대화 출력은 한국어; 코드, 커밋, 문서, 구조화된 스킬 출력은 영어.  
```  
**예상 공수:** 15분. 세션당 입력 토큰 ~420개 + 출력 토큰 ~2,000개 절감.  
  
---  
  
### P3 — 커밋 컨벤션 PostToolUse 경고 훅 추가  
**담당: Quality Lead**  
**근거:** 커밋 컨벤션(`[MAINTENANCE]`/`[NEW FEATURE]`/`[BREAKING CHANGES]`)은 2026-02-22에 추가되었으며 실전 테스트가 없었다. 소프트 리마인더 훅(PostToolUse, exit 0)은 빠른 이터레이션 세션을 차단하지 않으면서 컨벤션 가시성을 높인다. 이 훅은 템플릿 레포와 함께 자동으로 배포된다 — 클론마다 수동 설치가 필요한 git 레벨 훅과 달리.  
**구현:**  
```bash  
#!/bin/bash  
# PostToolUse: check-commit-convention.sh  
INPUT=$(cat)  
TOOL=$(echo "$INPUT" | jq -r '.tool_name // empty')  
[[ "$TOOL" != "Bash" ]] && exit 0  
COMMAND=$(echo "$INPUT" | jq -r '.tool_input.command // empty')  
echo "$COMMAND" | grep -q 'git commit' || exit 0  
MSG=$(git log -1 --format='%s' 2>/dev/null)  
[[ -z "$MSG" ]] && exit 0  
if ! echo "$MSG" | grep -qE '^\[(MAINTENANCE|NEW FEATURE|BREAKING CHANGES)\]'; then  
  echo "[Hook] 커밋 메시지가 컨벤션을 따르지 않음: \"$MSG\"" >&2  
  echo "필요한 접두사: [MAINTENANCE], [NEW FEATURE], 또는 [BREAKING CHANGES]" >&2  
  echo "제안: git commit --amend -m \"[PREFIX] $MSG\"" >&2  
fi  
exit 0  
```  
**예상 공수:** 20분.  
  
---  
  
### P4 — `/project:resume` 커맨드 생성  
**담당: Evangelist**  
**근거:** 두 프로젝트 워크로그 모두에서 컨텍스트 재개가 매 세션의 첫 번째 수작업인 다중 세션이 확인된다(`worklog.doing.md` 읽기, 활성 플랜 찾기, 이전 중단 지점 확인). `progress-guardian` 에이전트는 체크포인트를 기록하지만 세션 시작에 해당하는 상대역이 없다. 30줄짜리 커맨드 템플릿으로 두 프로젝트 전체에서 관찰된 가장 마찰이 큰 수작업을 제거할 수 있다.  
**읽는 파일:** `localdocs/worklog.doing.md`, `localdocs/worklog.todo.md`, 활성 `localdocs/plan.*.md`, 가장 최근 `localdocs/learn.*.md`.  
**예상 공수:** 30분 (마크다운 템플릿, 코드 없음).  
  
---  
  
### P5 — `document-management.md`에 ADR 네이밍 컨벤션 추가  
**담당: Quality Lead**  
**근거:** ADR은 두 프로젝트에서 가장 아키텍처적으로 중요한 문서(real-estate-mcp 4개, that-night-sky 11개)이지만, 문서 관리 네이밍 테이블에 ADR 항목이 없다. 두 프로젝트 모두 이미 네이밍 불일치를 보인다(real-estate-mcp에서 `adr-001-*` 케밥 케이스와 `adr.*` 닷 접두사가 혼재). 다음 테이블 행 하나를 추가한다:  
  
| Architecture Decision Record | `adr/adr-NNN-*.md` | `localdocs/adr/adr-001-mcp-refactor.md` |  
  
그리고 규칙 하나: "ADR 번호는 프로젝트별 순차적. 번호 뒤에는 케밥 케이스 사용. 번호 재사용 또는 건너뜀 금지."  
**예상 공수:** 5분.  
  
---  
  
### 백로그 (긴급하지 않으나 기록)  
  
| 항목 | 식별자 | 유예 이유 |  
|------|--------|-----------|  
| `commands/review-team.md`의 하드코딩된 절대 경로 수정 | New Member | 실행 빈도 낮음; 다른 머신에서만 문제 발생 |  
| `.gitignore`에 `settings.local.json` 추가 | New Member | 보안 위생; 즉각적 위험 낮음 |  
| `document-management.md`에 `localdocs/` 부트스트랩 안내 추가 | Prompt Engineer | 누락이지만 수동으로 발견하기 어렵지 않음 |  
| `CLAUDE.md`에 `skills.nouse/` 컨벤션 설명 추가 | New Member | 한 줄 추가 |  
| 비밀/도메인 위생 규칙 추가 | Prompt Engineer + Quality Lead | DDNS 유출 사건; 예방 규칙 성문화 |  
| tdd-guardian에 범위 조항 추가 ("TDD 예외: 인프라, 스파이크, 문서") | Prompt Engineer | 정당한 탐색적 작업을 TDD 교조주의가 막는 것 방지 |  
| `settings.json`에서 미사용 MCP 서버(arxiv, playwright) 제거 | Token CFO | 사용 증거 없음; 순수 컨텍스트 오버헤드 |  
| `coding-guidelines.md` Rule 5에 uv 설명 괄호 추가 | Prompt Engineer | 사소함, 괄호 한 줄 |  
| `CLAUDE.md`에 진입점 / 읽기 순서 추가 | Prompt Engineer | 템플릿 포크 시 도움; 복잡도 낮음 |  
| P3의 보완책으로 git 레벨 `commit-msg` 훅 고려 | Token CFO | 커버리지 더 넓음(비-Claude 커밋 포함); 클론별 설정 필요 |  
  
---  
  
## 충돌 해소 (Round 3 피어 메시징 후 최종 확정)  
  
### CONFLICT 1 — thinking-guidelines.md: 해소됨 (3자 합의)  
  
세 측(CFO, Prompt Engineer, New Member) 모두 다음에 수렴:  
- **삭제:** `.claude/rules/thinking-guidelines.md`  
- **인라인 추가:** 아래 5줄을 `CLAUDE.md`의 `## Communication and Reasoning Style` 섹션 아래 추가:  
  
```markdown  
- 한국어(해요/어요 체)로 답변. 간결하고 분석적으로. 코드, 커밋, 구조화된 출력은 영어로.  
- 결론을 먼저 서술. 사실과 가정을 분리.  
- 복잡한 질문에 답하기 전에 사실, 가정, 선호로 분해.  
- 대안을 다루기 전에 결론을 긍정 형태로 표현("B다").  
- 칭찬, 필러, 이모지 금지.  
```  
  
**제거 항목:** 멀티 페르소나 규칙(Rule 2) — 사용 증거 없음, 출력 토큰 비용 최대. 후속 제안(Rule 4) — 실증된 가치 없음.  
**순 변경:** -1 파일, -52줄, +5 인라인 줄. 한국어/영어 경계 명확해짐.  
  
### CONFLICT 2 — 커밋 컨벤션 적용 메커니즘: 해소됨 (단계적 접근)  
  
세 측(CFO, Evangelist, Quality Lead) 모두 단계적 구현에 합의:  
  
1. **즉시(P3):** `.claude/hooks/check-commit-convention.sh`에 PostToolUse 소프트 경고 훅 — exit 0, 비차단. 템플릿 레포와 함께 자동 배포. 커밋의 약 90%(Claude 작성)를 감지.  
2. **백로그 후속:** 기존 `.pre-commit-config.yaml`에 `commit-msg` 단계 추가 — pre-commit 프레임워크를 통한 git 레벨 적용. 모든 출처의 커밋 감지(Claude, 수동, Codex, CI). 클론별 `pre-commit install` 필요.  
  
**트레이드오프 정리:** Git 레벨 훅은 커버리지가 더 넓지만(비-Claude 커밋 감지) 클론별 설정이 필요하다. Claude 훅은 템플릿에서 자동 배포되지만 Claude Code 세션에서만 동작한다. Claude를 주로 활용하는 1인 개발자에게는 Claude 훅이 즉시 주요 케이스를 커버한다. Git 훅은 팀 사용이나 CI가 시작될 때 방어 심층을 제공한다.  
  
**거부됨:** PreToolUse 하드 블록 훅 — 커밋을 하드 블록하면 재시도 토큰이 낭비되고, 쉽게 amend 가능한 형식 문제에 비해 마찰이 과도하다.  
  
---  
  
## Round 2 CFO 검토 결과 (Evangelist 제안)  
  
| 제안 | CFO 판정 | 팀 결과 |  
|------|---------|---------|  
| 커밋 컨벤션 훅 | 승인 (git 훅으로) | P3으로 채택 (Claude 훅) |  
| 워크로그 상태 일관성 훅 | 거부 — 문제 증거 없음 | 거부 |  
| localdocs 네이밍 검증 훅 | 승인 | 백로그 (긴급도 낮음) |  
| 커밋 전 품질 게이트 훅 | 거부 — pre-commit이 이미 처리 | 거부 |  
| `/project:resume` 커맨드 | 조건부 승인 | P4로 채택 |  
| pre-commit 통합 스킬 | 거부 — Claude가 이미 알고 있음 | 거부 |  
| 프로젝트 간 동기화 커맨드 | 거부 — git submodule 사용 | 거부 |  
| 병렬 check+audit | 승인 — 추가 비용 없음 | 사용 패턴으로 문서화 |  
| 병렬 지식 병합 (learn+adr) | 승인 — 추가 비용 없음 | 사용 패턴으로 문서화 |  
  
---  
  
## 잘 작동하고 있는 것들  
  
- `coding-guidelines.md`: 두 프로젝트 전반에 걸쳐 구체적인 증거와 함께 강한 ROI. Rule 2, 4, 5, 6, 7, 8 모두 채택 산출물(learn 파일, 워크로그 항목, ADR) 확인. 규칙별 "테스트 휴리스틱"은 훌륭한 프롬프트 설계다.  
- `document-management.md`: 워크로그 네이밍 컨벤션(`todo/doing/done`)이 두 프로젝트 모두에서 일관되게 준수된다. 파일당 단일 주제 원칙도 유지된다.  
- `check-new-test-file.sh`와 `check-external-lib-usage.sh`: 잘 조정되어 있다(하드 블록 vs 권고). 외부 라이브러리 훅은 learn 파일에서 확인되는 Auth0 엔드포인트 발견 패턴에 직접 기여했다.  
- `commit-convention.md` 자체: 세 접두사 컨벤션은 올바르다. `[FIX]` 누락은 의도적 — 버그 수정은 외부 계약을 변경하지 않는 한 `[MAINTENANCE]`에 속한다. 설계는 정확하고, 집행 수단만 없었다.  
- `localdocs/` 생태계: ADR, learn 파일, 워크로그 패턴이 성숙하고 잘 활용되고 있다. Learn 파일(`learn.auth0-oauth.md`, `learn.numpy2-nan-cast-and-skyfield-range-error.md`, `learn.i18n-consistency.md`)은 고품질이며 정확히 올바른 형태의 지식 캡처 방식이다.  
  